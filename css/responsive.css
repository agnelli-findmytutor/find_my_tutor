/* ==========================================================================
   MOBILE OPTIMIZATION - "PERFECT MOBILE"
   Target: Smartphones (< 768px)
   Strategy: 2-Column Grids where possible to reduce scroll length
   ========================================================================== */

@media screen and (max-width: 768px) {

    /* --- 1. TYPOGRAPHY & SPACING --- */
    html {
        font-size: 14px; /* Slightly smaller base font */
    }

    h1 { font-size: 1.8rem !important; line-height: 1.2 !important; }
    h2 { font-size: 1.5rem !important; }
    h3 { font-size: 1.2rem !important; }
    p { font-size: 0.95rem !important; line-height: 1.5 !important; }

    /* Reduce massive paddings */
    section, 
    .agenda-wrapper, 
    .dashboard-wrapper, 
    .application-wrapper,
    .container-agenda, /* Aggiunto container prenota */
    .hero,
    .stats-dashboard,
    .courses-info-section,
    .group-courses-section,
    .become-tutor-section {
        padding-left: 15px !important;
        padding-right: 15px !important;
        padding-top: 60px !important;
        padding-bottom: 40px !important;
    }

    /* --- 2. HEADER & NAVIGATION --- */
    header {
        padding: 10px 20px !important;
        background: rgba(255, 255, 255, 0.98) !important; /* Solid white for readability */
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        height: 60px;
    }

    .logo span {
        font-size: 1.1rem;
        color: #333 !important; /* Force dark text */
    }

    .logo-icon {
        font-size: 1.3rem;
    }

    .menu-toggle {
        color: #333 !important;
        font-size: 1.5rem;
        display: block !important;
    }

    /* Ensure sidebar is correct */
    .nav-links {
        width: 80% !important;
        max-width: 300px;
        padding-top: 80px;
        background: white !important;
    }

    /* --- 3. HOME PAGE (index.html) --- */
    
    /* Hero */
    .hero {
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: center;
        min-height: auto !important;
        padding-top: 100px !important;
    }
    
    .hero-content { margin-bottom: 30px; }
    .hero-btns { justify-content: center; }
    
    .hero-visual {
        width: 100%;
        height: 250px;
        transform: scale(0.9);
        margin-top: -20px;
    }

    /* Search Bar */
    .search-wrapper { margin: 0 15px; }
    .search-box {
        flex-direction: column;
        padding: 10px;
        border-radius: 15px;
    }
    .divider { display: none; }
    .search-btn { width: 100%; margin-top: 10px; padding: 12px; }

    /* FEATURES GRID - FORCE 2 COLUMNS */
    .grid-container {
        display: grid;
        grid-template-columns: 1fr 1fr !important;
        gap: 10px !important;
    }

    .feature-card {
        padding: 15px !important;
        border-radius: 12px !important;
    }
    
    .card-icon-bg {
        width: 45px; height: 45px; font-size: 1.2rem; margin-bottom: 10px;
    }
    
    .feature-card h3 { font-size: 1rem !important; margin-bottom: 5px; }
    .feature-card p { 
        font-size: 0.8rem !important; 
        margin-bottom: 10px;
        display: -webkit-box;
        -webkit-line-clamp: 3; /* Limit text lines */
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    /* STATS - FORCE 2 COLUMNS */
    .stats-row {
        display: grid;
        grid-template-columns: 1fr 1fr !important;
        gap: 10px !important;
    }
    /* Make the 3rd item span full width to look good */
    .stat-box-modern:last-child {
        grid-column: span 2;
    }
    
    .stat-box-modern { padding: 15px !important; }
    .stat-icon-wrapper { width: 50px; height: 50px; font-size: 1.3rem; margin-bottom: 10px; }
    .stat-data h3 { font-size: 2rem !important; }

    /* INFO GRID - FORCE 2 COLUMNS */
    .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr !important;
        gap: 10px !important;
    }
    
    .info-card { padding: 15px !important; }
    .card-header { flex-direction: column; align-items: flex-start; gap: 8px; margin-bottom: 8px; }
    .icon-circle { width: 40px; height: 40px; font-size: 1.1rem; }
    .card-header h4 { font-size: 0.95rem !important; }
    .info-card p { font-size: 0.8rem !important; line-height: 1.3 !important; }

    /* --- 4. PRENOTA (prenota.html) --- */
    
    .page-header {
        margin-bottom: 30px !important;
        margin-top: 20px !important;
    }

    .split-layout {
        grid-template-columns: 1fr !important;
        gap: 20px !important;
    }

    /* Input Data/Ora: mantieni 2 colonne ma con meno gap */
    .row-group {
        grid-template-columns: 1fr 1fr !important;
        gap: 10px !important;
    }

    .card-box { 
        padding: 20px !important; 
        border-radius: 16px !important;
    }
    
    /* Pillole Durata Mobile */
    .duration-pills {
        gap: 8px !important;
    }
    .duration-pills label {
        padding: 12px 5px !important;
        font-size: 0.9rem !important;
        flex: 1 1 30% !important; /* 3 per riga o wrap */
    }

    /* Card Lezione Mobile - Ridisegnata */
    .lesson-item {
        flex-direction: column !important;
        align-items: flex-start !important;
        padding: 15px !important;
        gap: 12px !important;
        border-left-width: 4px !important;
    }
    
    .lesson-info { width: 100% !important; }
    .lesson-info h4 { font-size: 1rem !important; margin-bottom: 5px !important; }
    
    .lesson-actions {
        flex-direction: row !important;
        width: 100% !important;
        justify-content: space-between !important;
        border-left: none !important;
        border-top: 1px solid #f0f0f0 !important;
        padding-left: 0 !important;
        padding-top: 12px !important;
        margin-top: 5px !important;
        gap: 10px !important;
    }
    
    /* Pulsanti Touch Friendly */
    .btn-mini { 
        flex: 1 !important; 
        margin: 0 !important; 
        height: 40px !important; /* PiÃ¹ alti per il dito */
        font-size: 0.9rem !important;
        justify-content: center !important;
    }
    
    .btn-confirm-booking {
        padding: 15px !important;
        font-size: 1rem !important;
    }
    
    .lessons-scroll-area {
        max-height: 450px !important;
    }

    /* --- 5. DIVENTA TUTOR (diventa_tutor.html) --- */
    
    /* Form Inputs: Stack on mobile for better usability */
    .form-row-split {
        grid-template-columns: 1fr !important;
        gap: 15px !important;
    }
    
    .modern-form { padding: 0 20px 30px !important; }
    .form-header { padding: 30px 20px !important; }
    
    /* Status Banner Mobile */
    .status-banner {
        flex-direction: column !important;
        text-align: center !important;
        gap: 15px !important;
        padding: 20px !important;
    }
    .status-icon { font-size: 2rem !important; }
    
    /* Action Buttons Stack */
    .btn-group-action {
        flex-direction: column !important;
        gap: 10px !important;
    }
    .btn-action { width: 100% !important; }
    
    /* Availability Slots Chips */
    #slotsContainer .avail-chip {
        width: 100% !important;
        justify-content: space-between !important;
        margin-bottom: 5px !important;
        padding: 8px 12px !important;
    }

    /* --- 6. APPUNTAMENTI (appuntamenti.html) --- */
    
    .dashboard-grid {
        grid-template-columns: 1fr !important;
        gap: 25px !important;
    }

    /* Notice Cards - 1 Column on Mobile for better text fit */
    .copy-grid {
        grid-template-columns: 1fr !important;
        gap: 10px !important;
    }
    
    .copy-card {
        flex-direction: row !important; /* Icona a sinistra, testo a destra */
        text-align: left !important;
        padding: 15px !important;
        align-items: center !important;
    }
    
    .card-icon { margin-bottom: 0 !important; margin-right: 15px !important; }
    .btn-copy { width: auto !important; background: transparent !important; margin-top: 0 !important; align-self: center !important; }

    /* Calendar Lessons - 1 Column for readability */
    #appointmentsList {
        grid-template-columns: 1fr !important;
        gap: 15px !important;
    }
    
    .day-header {
        grid-column: span 1 !important;
        margin-bottom: 10px !important;
        margin-top: 20px !important;
    }

    .lesson-card {
        padding: 15px !important;
        border-left-width: 4px !important;
    }
    
    .card-main {
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 10px !important;
    }
    
    .time-display {
        width: 100% !important;
        text-align: left !important;
        background: transparent !important;
        padding: 0 !important;
        color: var(--agnelli-red) !important;
        font-size: 1.1rem !important;
        margin-bottom: 5px !important;
    }
    
    .info-display h4 {
        font-size: 1rem !important;
    }
    
    .card-actions {
        margin-top: 15px !important;
        padding-top: 10px !important;
        border-top: 1px solid #eee !important;
        text-align: left !important;
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
    }
    
    /* Tabs Scrollabili */
    .tabs-nav {
        flex-wrap: nowrap !important;
        overflow-x: auto !important;
        padding-bottom: 5px !important;
        justify-content: flex-start !important;
        gap: 10px !important;
    }
    .tab-btn {
        flex: 0 0 auto !important;
    }

    /* --- 7. PROGETTO (progetto.html) --- */
    
    .story-hero {
        padding: 120px 20px 60px !important; /* Spazio extra per header fisso */
        height: auto !important;
        min-height: auto !important;
    }
    
    .hero-text h1 {
        font-size: 2.2rem !important;
    }

    .timeline-section::after {
        left: 30px !important; /* Linea spostata a sinistra */
        bottom: 0 !important;
    }
    
    .timeline-item {
        width: 100% !important;
        padding-left: 80px !important; /* Spazio sicuro per non sovrapporre la linea */
        padding-right: 15px !important;
        left: 0 !important;
        margin-bottom: 30px !important;
        text-align: left !important;
    }
    
    /* Reset alternating sides */
    .right { left: 0 !important; }
    
    /* Pallini Timeline */
    .timeline-item::after {
        left: 20px !important; /* Centrato sulla linea (30px) */
        right: auto !important;
        transform: none !important;
        border-width: 3px !important;
    }
    
    /* Gestione Card Centrali (Fusione/Lancio) su Mobile */
    .center-highlight { margin-bottom: 30px !important; }
    
    .center-highlight .timeline-content {
        border-left: 4px solid var(--red-main) !important; /* Ripristina bordo laterale */
        border-top: none !important;
        text-align: left !important;
    }
    
    /* Forza pallino anche per le card centrali */
    .center-highlight::after {
        display: block !important;
        content: '' !important;
        position: absolute !important;
        width: 20px !important;
        height: 20px !important;
        background-color: white !important;
        border: 3px solid var(--red-main) !important;
        border-radius: 50% !important;
        top: 25px !important;
        left: 20px !important;
        z-index: 2 !important;
    }
    
    .timeline-content { padding: 20px !important; }
    
    .dual-story {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    .story-separator { display: none; }

    /* --- 8. FOOTER --- */
    .footer-grid {
        grid-template-columns: 1fr 1fr !important; /* 2 Colonne per risparmiare altezza */
        text-align: left !important;
        gap: 20px !important;
        padding-bottom: 20px;
    }
    
    /* Brand occupa tutta la larghezza in alto */
    .footer-col.brand-col {
        grid-column: 1 / -1;
        text-align: center;
        margin-bottom: 10px;
        border-bottom: 1px solid rgba(255,255,255,0.05);
        padding-bottom: 20px;
    }

    .footer-col h4::after {
        left: 0 !important;
        transform: none !important;
    }
    
    .contact-link { margin: 0; width: 100%; padding: 8px !important; }
    .contact-link .icon-box { width: 30px; height: 30px; font-size: 0.9rem; }
    .contact-link span { font-size: 0.75rem; }
    
    .social-area { align-items: flex-start !important; margin-top: 10px; }
    
    .footer-bottom {
        flex-direction: column;
        gap: 15px;
        text-align: center;
    }
}

/* --- EXTRA SMALL DEVICES (iPhone SE, Fold) --- */
@media screen and (max-width: 360px) {
    /* Revert to 1 column if screen is too narrow for 2 columns */
    .grid-container, 
    .stats-row, 
    .info-grid, 
    .copy-grid, 
    #appointmentsList,
    .row-group,
    .form-row-split {
        grid-template-columns: 1fr !important;
    }
    
    .stat-box-modern:last-child { grid-column: auto; }
}